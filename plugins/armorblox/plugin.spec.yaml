plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: armorblox
title: Armorblox
description: Armorblox secures enterprise communications over email and other cloud office applications with the power of Natural Language Understanding. The Armorblox platform connects over APIs and analyzes thousands of signals to understand the context of communications and protect people and data from compromise. Over 56,000 organizations use Armorblox to stop BEC and targeted phishing attacks, protect sensitive PII and PCI, and automate remediation of user-reported email threats. Armorblox was featured in the 2019 Forbes AI 50 list and was named a 2020 Gartner Cool Vendor in Cloud Office Security. Founded in 2017, Armorblox is headquartered in Sunnyvale, CA and backed by General Catalyst and Next47
version: 1.0.0
vendor: armorblox
support: rapid7
supported_versions: ["1.0.0"]
status: []
tags: ["Alerts", "Attack", "Breach", "Compliance", "Email", "Forensics", "GDPR", "HIPAA", "Incident Response", "IT", "Machine Learning", "Malware", "PII", "Scam", "Security", "Security Analytics", "Spam", "Threat Intelligence"]
hub_tags:
  use_cases: ['cloud_security', 'remediation_management',  'threat_detection_and_response']
  keywords: ['threat_intelligence']
  features: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/armorblox
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://armorblox.com/
enable_cache: true

types:
  user:
    name:
      title: user name
      description: User name
      type: string
      required: false
    email:
      title: User email
      description: User email
      type: string
      required: false
    is_vip:
      title: Is User VIP
      description: Is User VIP
      type: boolean
      required: false
  final_detection_tag:
    detection_tag_id:      
      title: Detection tag ID
      description: Detection tag ID
      type: string
      required: false
    detection_tag_name:
      title: Detection tag name
      description: Detection tag name
      type: string
      required: false    
  engagement:
    fwd_mail_count:
      title: Mail Count
      description: Mail Count
      type: string
      required: false
    reply_mail_count:
      title: Mail Count
      description: Mail Count
      type: string
      required: false
  incident:
    priority:
      title: Priority
      description: Priority of the incident
      type: string
      required: false
    tagged:
      title: Is email tagged
      description: Is email tagged
      type: boolean
      required: false
    date:
      title: Incident Date
      description: 
      type: date
      required: false
    policy_names:
      title: policy_names
      description: List of policies
      type: '[]string'
      required: false
    title:
      title: Subject
      description: Subject
      type: 'string'
      required: false          
    resolution_state:
      title: resolution_state
      description: Resolution State
      type: string
      required: false
    object_type:
      title: Object Type
      description: Object Type
      type: string
      required: false 
    id:
      title: Incident ID
      description: Incident ID
      type: string
      required: false
    app_name:
      title: App Name
      description: App Name
      type: string
      required: false 
    external_senders:
      title: External senders
      description: List of external senders
      type: "[]string"
      required: 
    folder_categories:
      title: Folder categories
      description: Folder categories
      type: "[]string"
      required: false
    scl_score:
      title: SCL Score
      description: 
      type: integer
      required: false
    incident_type:
      title: Incident Type
      description: Incident Type
      type: string
      required: 
    engagements:
      title: Engagements
      description: Engagements 
      type: engagement
      required: false
    remediation_actions:
      title: Remediation Action
      description: Remediation Action
      type: "[]string"
      required: false
    users:
      title: users
      description: List of users
      type: "[]user"
      required: false
    external_users:
      title: External users
      description: List of external users
      type: "[]user"
      required: false
    final_detection_tags:
      title: Detection tags
      description: Detection tags 
      type: "[]final_detection_tag"
      required: false

connection:
  tenant_name:
    title: Tenant Name
    description: Armorblox Tenant Name
    type: string
    required: true
    example: outbound-integrations
  api_key:
    type: credential_secret_key
    title: Armorblox API Key
    description: Armorblox API Key
    required: true
    example: 9de5069c5afe602b2ea0a04b66beb2c0

triggers:
  get_incidents:
    title: Get Incidents
    description: Get a list of incidents identified by Armorblox. By default, it starts querying for all the incidents since the previous day
    input:
      interval:
        title: Fetch Interval
        description: Polling interval in seconds
        type: integer
        required: false
        default: 600
        example: 600
    output:
      incidents:
        title: Incidents
        description: A list of incidents identified by Armorblox
        type: "[]incident"
        required: true

actions:
  get_remediation_action:
    title: Get Remediation Action
    description: Get remediation action of an incident identified by Armorblox
    input:
      incident_id:
        title: Incident ID
        description: An integer number identifying the incident
        type: string
        required: true
        example: 3490
    output:
      remediation_details:
        title: Remediation Details
        description: Remediation Action of the requested incident identified by Armorblox
        type: string
        required: true